---
title: "打开/关闭评估结果"
description: "打开/关闭评估结果"
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/hardware
ms.assetid: 7aa9fcbc-4019-4be0-829a-d50eadc6ca02
ms.prod: W10
ms.mktglfcycl: plan
ms.sitesec: msdn
ms.openlocfilehash: bd44cde5ff0f947b5425c6998ff34d6af6d9124e
ms.sourcegitcommit: d33e870dc4850bf0ea47fdae0d163b04c1c90f15
translationtype: MT
---
# <a name="results-for-the-onoff-assessments"></a>打开/关闭评估结果


本主题有助于您理解开/关评估 （启动性能 （快速启动） 启动性能 （完整的启动），待机性能，休眠性能） 所产生的结果。 它还提供有关如何使用结果来识别和解决对最终用户的体验时关闭和引导计算机产生负面影响的几个常见问题的指导。

本主题︰

-   [目标文件](#bkmk-goals)

-   [指标](#fs-metrics)

-   [问题](#fs-issues)

-   [时间关键任务的最佳做法](#fs-analysis)

开/关切换评估有关的详细信息，请参阅[开/关切换性能](onoff-transition-performance.md)。

## <a name="a-href-idbkmk-goalsagoals-file"></a><a href="" id="bkmk-goals"></a>目标文件


您可以创建自定义的目标来衡量结果视图中的您改进。 目标文件是会审的工具，可帮助您了解 PC 的性能如何，比较 Pc 业务中。

例如，基本的便携式计算机目标可能不同于为高端桌面计算机设置的目标或者市场预期可能会更改所需的灵活性，可以定义不同类型的目标和时间的推移和技术的关键要求提高的方式中。

度量值是与该指标的目标相比，状态都用颜色编码在结果视图中，如下所示︰

-   浅紫色意味着系统具有出色的用户体验，有没有感觉到的问题。

-   紫色的中等意味着用户体验是容许，可以优化系统。 检查以查看可对系统进行何种改进的建议和分析。 这可能是软件更改，更改配置或硬件更改。

-   深紫色意味着系统有很差的用户体验，并且有重大改进的空间。 检查以查看可对系统进行改进的建议和分析。 这可能是软件更改，更改配置或硬件更改。 您可能需要考虑进行权衡，以便提供 Windows 遇到的高质量。

-   没有颜色的含义有没有定义为度量的目标。

**请注意**  
在 Windows 评估 Toolkit 针对 Windows 8，某些评估包括默认目标文件。 查看使用此版本的工具，结果在第一次使用该默认目标文件。 但是，您还可以定义自定义目标针对 Windows 8 相同的方式，可以为 Windows 8.1 和 Windows 10。

 

您可以设置文件位置的目标并将目标文件添加到该位置之前可用于用户界面应用的自定义目标。 选择目标文件后，它将继续是目标文件，用于打开的任何结果。

可每次只能有一个目标文件。 所有的评估的目标是单个目标文件中设置的。 评估工具将搜索顺序如下目标︰

1.  自定义的目标文件

2.  在结果文件中定义的目标

3.  评估清单中定义的目标

您可以在 %PROGRAMFILES%使用提供了该示例的目标文件\\窗口工具包\\10\\评估和部署工具包\\Windows 评估 Toolkit\\SDK\\样本\\目标来创建目标文件。

**请注意**  
不能包装作业的目标文件，但可以将其存储在供其他用户使用共享。

 

## <a name="a-href-idfs-metricsametrics"></a><a href="" id="fs-metrics"></a>指标


本部分介绍指标报告的开/关评估，常见的导致这些度量标准差结果和通用修正与这些指标相关的问题的关键。 本部分还可以帮助您识别其衡量标准是最适用的观众。

在此部分中︰

-   [关闭持续时间和暂停持续时间](#oo-shutdown-duration)

-   [用户会话关闭持续时间](#oo-user-session-shutdown-duration)

-   [关闭进程持续时间](#oo-shutdown-processes)

-   [Winlogon 暂停持续时间和 Winlogon 通知持续时间](#oo-winlogon-suspend)

-   [挂起的进程持续时间](#oo-suspend-processes-duration)

-   [挂起服务持续时间](#oo-suspend-services-duration)

-   [Superfetch 准备内存持续时间](#oo-superfetch-prepare-memory-duration)

-   [查询设备持续时间](#oo-query-devices-duration)

-   [将刷新存储卷持续时间](#oo-flush-storage-volumes-duration)

-   [挂起的设备持续时间](#oo-suspend-devices-duration)

-   [后写持续时间](#oo-hiberfile-write-duration)

-   [BIOS 初始化持续时间](#oo-bios-initialization-duration)

-   [总启动\[不包括 BIOS\]持续时间和总恢复\[不包括 BIOS\]持续时间](#oo-total-boot)

-   [主路径引导持续时间与主路径恢复持续时间](#oo-main-path)

-   [引导管理器](#oo-boot-manager)

-   [读后持续时间](#oo-hiberfile-read-duration)

-   [恢复设备持续时间](#oo-resume-devices-duration)

-   [Winlogon 恢复持续时间](#oo-winlogon-resume-duration)

-   [资源管理器初始化持续时间](#oo-explorer-initialization-duration)

-   [开机自检打开/关闭持续时间](#oo-post-on-off-duration)

**请注意**  
如果启用启用微筛选器诊断模式设置，评估结果将包括微筛选器规格。 有关微筛选器的指标和结果的详细信息，请参阅[微筛选器诊断程序](minifilter-diagnostics.md)。

 

### <a name="a-href-idoo-shutdown-durationashutdown-duration-suspend-duration"></a><a href="" id="oo-shutdown-duration"></a>关闭持续时间和暂停持续时间

**相关评估︰**

-   启动性能 （快速启动）

-   启动性能 （完整的启动）

-   待机性能

-   休眠状态的性能

此指标衡量计算机处于关闭中的时间或挂起的操作。 下表描述了每个评估的指标︰

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>评估</th>
<th>指标说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>引导 （快速启动） 的性能评估</p></td>
<td><p>该指标从关机阶段，开始捕获时间的末尾写入磁盘，并转换为低电源状态 (S4) 后。</p></td>
</tr>
<tr class="even">
<td><p>引导 （完整的启动） 的性能评估</p></td>
<td><p>此统计数据捕获从关闭阶段开始时间转换到已通电 off 状态。</p></td>
</tr>
<tr class="odd">
<td><p>待机性能评估</p></td>
<td><p>此统计数据转换到低电源状态 (S3) 捕获从休眠阶段的开始的时间。</p></td>
</tr>
<tr class="even">
<td><p>休眠状态的性能评估</p></td>
<td><p>此度量捕获时间从休眠到结尾后写入磁盘，并转换为低电源状态 (S4)。</p></td>
</tr>
</tbody>
</table>

 

**详细的子指标**

指标展开的一份关闭或挂起时显示子阶段。

**请注意**  
子阶段的持续时间不一定增加到整体的持续时间。

 

**典型的影响因素**

此统计数据是系统关机/休眠总体指标。 它可以受任何/休眠关机的路径运行的软件组件。

**分析和补救措施**

展开的子指标，在各个子关机/休眠阶段提供的详细信息，请参阅该度量。 检查各个子阶段指标和问题，以找到潜在延迟 contributors （参与者）。

### <a name="a-href-idoo-user-session-shutdown-durationauser-session-shutdown-duration"></a><a href="" id="oo-user-session-shutdown-duration"></a>用户会话关闭持续时间

**相关评估︰**

-   启动性能 （快速启动）

此指标用于衡量计算机处于关闭用户会话的时间。 这一阶段包括关闭用户会话进程、 用户注销，并通知到 Winlogon 通知的订阅服务器。 指标展开的一份关闭或挂起时显示子阶段。

**请注意**  
子阶段的持续时间不一定增加到整体的持续时间。

 

此统计数据是关闭系统的总体指标。 它可以受任何关闭路径运行的软件组件。

**分析和补救措施**

展开此统计数据以查看各个子阶段的关闭提供详细信息的子指标。 检查各个子阶段指标和问题，以找到潜在延迟 contributors （参与者）。

### <a name="a-href-idoo-shutdown-processesashutdown-processes-duration"></a><a href="" id="oo-shutdown-processes"></a>关闭进程持续时间

**最适用于︰**应用程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

当评估启动用户会话关闭时，每个 UI 线程在每个图形用户界面 (GUI) 应用程序发送 WM\_QUERYENDSESSION 消息。 Windows 在接收响应 WM 后\_QUERYENDSESSION 消息窗口发送 WM\_ENDSESSION 到相同的线程。 如果 5 秒钟没有响应这些通知的任何应用程序后，Windows 会终止应用程序。 任何应用程序可以通过未及时响应消息延迟系统关闭。

**请注意**  
如果用户启动关机，用户对话框将显示在超时过期之后。 此对话框显示信息的应用程序正在阻止关闭，并使用户可以**强制**或**取消**关机。

 

此指标用于衡量计算机处于关闭在用户会话中所有进程的时间。

**详细的子指标**

规格，展开时，更详细的视图显示子的测量数据，测量每个单独进程响应关闭通知所花费的时间的一组。 列显示以下信息︰

-   按详细信息列中的迭代 PID。 在默认视图中，此列中可能包含值"各种"因为 Pid 不能聚合迭代间。 展开迭代来查看单个 Pid。

-   此特定过程在此阶段所花费的时间。

**典型的影响因素**

此统计数据捕获所有正在运行的进程有用户界面线程响应关闭通知的累计时间。 此统计数据可能受到一个过程中，花费的时间太长，除了所有进程响应的累计时间。

没有用户界面的线程中的每个进程可以延迟系统关机延迟响应 WM\_QUERYENDSESSION 消息或 WM\_ENDSESSION 消息。

**请注意**  
影响该指标，必须运行一个进程。 此评估服务重新启动之前它收集分析数据，因为正在运行的进程都几乎专门从启动应用程序或计划的任务。

 

**分析和补救措施**

您可以识别最大使用[查找最大参与者](#fs-issues)技术影响该指标的进程。

如果可能，请从启动路径中删除应用程序。 因为评估重新启动执行量化指标之前，只有应用程序在关机时运行是应用程序启动时开始。 作为一种最佳做法，启动应用程序应保持在最低水平。 如果 unessential 的应用程序导致的延迟，请考虑从启动应用程序的列表中移除它。

查找可能的原因该响应 WM\_QUERYENDSESSION 消息或 WM\_ENDSESSION 可以延迟和疑难解答并解决根本问题。 常见的最佳做法列表，请参见[的时间紧要任务的最佳做法](#fs-analysis)。

**其他信息**

[MSDN: WM\_QUERYENDSESSION 消息](http://go.microsoft.com/fwlink/?LinkId=247501)

[MSDN: WM\_ENDSESSION 消息](http://go.microsoft.com/fwlink/?LinkId=247502)

### <a name="a-href-idoo-winlogon-suspendawinlogon-suspend-duration-winlogon-notifications-duration"></a><a href="" id="oo-winlogon-suspend"></a>Winlogon 暂停持续时间和 Winlogon 通知持续时间

**最适用于︰**Winlogon 订阅服务器开发人员组策略脚本的所有者，系统管理员

**相关评估︰**

-   启动性能 （快速启动）

-   启动性能 （完整的启动）

-   待机性能

-   休眠状态的性能

此度量度量值由 Winlogon、 花费包括时间所花费的时间执行订阅服务器通知/回调。

启动性能 （快速启动） 方案中，在控制台窗口中评估**Winlogon 通知**指标反映处理所有 Winlogon 订户通知和回调所花费的累计时间。 但是，Windows® 性能分析器 (WPA) 时间轴中的来龙去脉， **Winlogon 通知**活动开始第一次订阅服务器通知/回调，结束其最后一个。 处理每个通知所花费的时间由各个子活动。

启动性能 （快速启动），是仅此度量提供附加的子指标的评估。 在挂起，Winlogon 问题同步的订阅服务器通知注册为以下四种通知类型的订阅服务器︰

-   终止会话

-   最终外壳

-   注销

-   创建会话

跃点数展开的当这些四种通知类型显示为子指标。 每种类型的订阅服务器 （例如，配置文件和 GPClient） 为其他子指标，并且每个订阅服务器上列出为该订阅服务器**连接到订阅服务器**并**调用订阅服务器上**的特定实例。

在任何情况下，Winlogon 订户可以延迟/休眠关机的时间太长，要处理这些通知。 例如，如果在计算机上启用了**漫游 （远程） 配置文件**功能 （配置文件） 中的配置文件服务必须进行同步的用户配置文件。 举一个例子，可能由系统或域策略才能执行某些任务在用户注销时配置组策略客户端 (GPClient)。 这些任务通常由系统管理员或域管理员配置。

**典型的影响因素**

检查此指标时，应着重 Winlogon 订阅服务器。

**分析和补救措施**

检查各个订阅服务器操作的时间。 对于具有更长的持续时间的订阅服务器通常生成特定的问题。 WPA 打开订阅服务器的时间间隔的更深的理解。 例如，如果 GPClient 订阅服务器上调用仅需 10 秒，WPA 在该期间的考试可以揭示打满分 9 秒运行自定义脚本。 这点脚本是延迟的高度可能的根本原因。

**其他信息**

[MSDN: Winlogon 通知事件](http://go.microsoft.com/fwlink/?LinkId=247505)

### <a name="a-href-idoo-suspend-processes-durationasuspend-processes-duration"></a><a href="" id="oo-suspend-processes-duration"></a>挂起的进程持续时间

**最适用于︰**应用程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   待机性能

-   休眠状态的性能

此指标用于衡量计算机所即将进行电源状态更改通知过程花费的时间。

在此阶段，客户端/服务器运行时服务器子系统 (Csrss.exe) 广播 WM\_POWERBROADCAST 窗口消息的事件类型的税前利润以及\_APMSUSPEND 为每个应用程序拥有一个窗口。 系统还可能关闭显示器的电源。

此活动可以被视为 WPA**活动**关系图中被挂起的连续进程之间存在很大差异。 一个第二个或更多应关闭显示器的电源。 这是暂停关闭期间，一个必要的阶段，它不应认为此度量的性能瓶颈。

在此期间，以显示下面的堆栈上的 csrss.exe 进程的 CPU 利用率看**CPU 使用率 （式采样）**关系图︰

``` syntax
[Root] (csrss.exe) 
winsrv.dll!RegisterForDeviceBroadcastNotifications 
|- winsrv.dll!ZwUserCallNoParam 
|    win32k.sys!xxxUserPowerStateCalloutWorker 
|    |- win32k.sys!PowerOffMonitor 
|    |    |- win32k.sys!FadeDesktop 
|    |    |- win32k.sys!DrvSetMonitorPowerState 
|    |    |- win32k.sys!UpdateDisplayState 
|    |    |- win32k.sys!DwmSyncClearSwapChain 
|    |    |- win32k.sys!RestoreGammaRamp
```

**挂起的进程**中由于其他堆栈或延迟，而无需到当前堆栈上的 CPU 利用率上的 CPU 消耗的间隙可以提出建议方面进一步研究。

跃点数展开的则显示更详细的阶段视图，套子的测量数据，测量每个进程挂起的通知作出响应所花费的时间。 列显示以下信息︰

-   按**详细信息**列中的迭代 PID。 在默认视图中，此列中可能包含值"各种"因为 Pid 不能聚合迭代间。 展开迭代来查看单个 Pid。

-   此特定过程在此阶段所花费的时间。

**请注意**  
如果应用程序具有多个窗口，同一进程可以接收多个通知。

 

**典型的影响因素**

每个应用程序已关闭延迟系统的能力通过延迟响应 WM\_POWERBROADCAST 其中税前利润\_APMSUSPEND 事件类型。 此统计数据捕获所有 windows GUI 进程都采取响应挂起通知的累计时间，因为该指标可能受到一个过程中，花费的时间太长，除了所有进程响应的累计时间。 请注意，必须运行该过程影响该指标;启动性能 （快速启动评估服务重新启动之前它收集分析数据，因为这些流程来自几乎完全只由启动应用程序或计划的任务。

**分析和补救措施**

确定最大影响该指标的进程。 在评估控制台窗口中，展开**挂起进程持续时间**规格，以获得这一阶段的详细信息。 在这一阶段的**过程**列表中，对**持续时间**的降序进行排序和查找的最大参与者。

如果可能，请从启动路径中删除应用程序。 作为一种最佳做法，启动应用程序应保持在最低水平。 如果 unessential 的应用程序导致的延迟，请考虑从启动应用程序的列表中移除它。

故障排除和解决问题，这极大地影响启动路径需要深入分析的应用程序的延迟。 常见的最佳做法列表，请参见[的时间紧要任务的最佳做法](#fs-analysis)。

**其他信息**

[MSDN︰ 税前利润\_APMSUSPEND 事件](http://go.microsoft.com/fwlink/?LinkId=247503)

### <a name="a-href-idoo-suspend-services-durationasuspend-services-duration"></a><a href="" id="oo-suspend-services-duration"></a>挂起服务持续时间

**最适用于︰**Windows 服务开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   待机性能

-   休眠状态的性能

此指标用于衡量计算机所用的即将的电源状态更改通知服务的时间。 注册以接收电源管理事件的所有服务 (服务\_接受\_POWEREVENT) 收到挂起的通知。 由于连续发送这些通知，服务中的任何延迟直接占到总体的关机/休眠持续时间。 30 秒超时强制 （基于每个服务） 来处理此通知;后此超时值，系统将移到下一个阶段。 由于此通知注册是可选的因此操作系统不需要服务任何特定操作。

**详细的子指标**

规格，展开时，更详细的阶段视图都会得到一份个别的服务和其相应的持续时间。

**典型的影响因素**

此统计数据捕获响应电源查询所需要的所有服务的累计时间。 此统计数据可能受到一个过程中，花费的时间太长，除了所有进程响应的累计时间。

大多数服务不需要进行任何重大工作响应待机和休眠电源通知。 从服务的角度来看，快速启动是类似休眠。

**分析和补救措施**

标识的服务，极大地影响该指标。 服务响应的时间长延迟通常会生成特定于给定服务的问题。 当生成此类问题时，您可以按照内部问题高级的问题的详细信息，请参阅以下链接。 不生成问题，随后在 WPA 的分析是必需的。 此附加的分析是本文的讨论范围之内。 有关常见的最佳做法的详细信息，请参阅[时间紧要任务的最佳做法](#fs-analysis)。

**其他信息**

[MSDN: OnNow/ACPI 支持](http://go.microsoft.com/fwlink/?LinkId=247504)

### <a name="a-href-idoo-superfetch-prepare-memory-durationasuperfetch-prepare-memory-duration"></a><a href="" id="oo-superfetch-prepare-memory-duration"></a>Superfetch 准备内存持续时间

**最适用于︰**应用程序开发人员、 窗口服务开发人员

**相关的评估**

1.  启动性能 （快速启动）

2.  待机性能

3.  休眠状态的性能

此指标用于衡量 Windows Superfetch 服务的内存状态准备后续启动恢复所花费的时间。 在简历上，superfetch 预回迁数据频繁访问启动时，并将其在后 （用于启动性能 （快速启动） 和休眠的性能） 或主内存 （待机性能） 存储以避免过多的磁盘访问。 此功能可以加速恢复过程。

**典型的影响因素**

在此阶段，Superfetch 服务在启动时读取的数据进行访问。 这一阶段的持续时间直接受影响的期间启动的启动应用程序、 服务、 凭据提供程序等必须读取的数据量。

**分析和补救措施**

此阶段要求不包括在此文档中的高级的分析。

### <a name="a-href-idoo-query-devices-durationaquery-devices-duration"></a><a href="" id="oo-query-devices-duration"></a>查询设备持续时间

**最适用于︰**驱动程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   待机性能

-   休眠状态的性能

在关机/休眠阶段中，每个设备驱动程序发送电源 IRP 具有 IRP\_明尼苏达州\_查询\_电源次代码和电源状态 (启动性能 （快速启动） 的 S4 / 休眠性能、 S3 待机性能)。 此指标用于衡量处理查询电源 IRP 的所有驱动程序的持续时间。

每个驱动程序可以通过未及时处理 IRP 延迟系统关闭。

**详细的子指标**

规格，展开时，更详细的阶段视图都会得到设备和其相应的持续时间的列表。

**典型的影响因素**

此统计数据捕获所有的驱动程序需要对电源的查询作出响应的累计时间。 此统计数据可能受到花很长时间来做出响应，除了所有驱动程序响应的累计时间单独的驱动程序。

**分析和补救措施**

您可以标识一个驱动程序或驱动程序通过查看子指标影响该指标。 在驱动程序响应期间通常较长延迟产生特定于给定驱动程序的问题。 当生成此类问题时，遵循内部问题高级的问题的详细信息，请参阅以下链接。 时不生成问题，随后在 WPA 的分析是必需的;这是本文的讨论范围之内。 常见的最佳做法列表，请参见[的时间紧要任务的最佳做法](#fs-analysis)。

**请注意**  
如果一个驱动程序拥有的设备的电源策略，它将生成响应接收系统电源 IRP 设备电源 IRP。 驱动程序不应该等到完成系统 IRP，直至设备 IRP 被完成，因为该等待可以防止其他设备接收其系统 Irp。 这一系列的等待原因序列化延迟并增加了整体暂停时间。

 

**其他信息**

[MSDN: IRP\_明尼苏达州\_查询\_电源](http://go.microsoft.com/fwlink/?LinkId=247506)

### <a name="a-href-idoo-flush-storage-volumes-durationaflush-storage-volumes-duration"></a><a href="" id="oo-flush-storage-volumes-duration"></a>将刷新存储卷持续时间

**最适用于︰**应用程序开发人员、 窗口服务开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   待机性能

-   休眠状态的性能

此指标衡量计算机，向注册表写入并保存到辅助存储的任何其他修改的网页所花费的时间。

**典型的影响因素**

该指标表示的时间取决于需要刷新的数据量。

**分析和补救措施**

标识负责此数据的过程需要超出了本文档; 范围的高级的分析但是，写入大量数据直接在关机之前的任何进程都可疑。

例子有︰ 直接在退出之前, 使用缓存的 I/O 写入数兆字节的数据文件的应用程序或服务关闭时修改大量文件映射内存。

### <a name="a-href-idoo-suspend-devices-durationasuspend-devices-duration"></a><a href="" id="oo-suspend-devices-duration"></a>挂起的设备持续时间

**最适用于︰**驱动程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   待机性能

-   休眠状态的性能

在启动性能 （快速启动方案关机阶段中，每个设备驱动程序发送电源 (IRP\_MJ\_电源) I/O (IRP 具有 IRP\_明尼苏达州\_设置\_电源次代码和电源状态 (启动性能 （快速启动） 或休眠性能的 S4)、 S3 待机性能。

此指标衡量所需的所有驱动程序来处理一组电源 IRP 的时间。

当设备驱动程序处理此 IRP，它们保存相应的设备上下文 （如果需要），以及传设备处于相应状态的睡眠或休眠状态。 每个驱动程序可以通过未及时处理 IRP 延迟系统关闭。

**详细的子指标**

规格，展开时，则会出现更详细的阶段视图包含一系列设备和其相应的持续时间。

**典型的影响因素**

此统计数据捕获所有的驱动程序需要对电源查询作出响应的累计时间。 该指标可以受单个驱动程序时间太长，除了所有响应的累计时间作出响应。

**请注意**  
如果一个驱动程序拥有的设备的电源策略，它将生成响应接收系统电源 IRP 设备电源 IRP。 驱动程序不应该等到完成系统 IRP，直至设备 IRP 被完成，因为该等待可以防止其他设备接收其系统 Irp。 这一系列的等待原因序列化延迟并增加了整体暂停时间。

 

**分析和补救措施**

您可以标识一个驱动程序或驱动程序通过查看子指标影响该指标。 长时间的延迟，在驱动程序响应期间通常生成特定于给定驱动程序的问题。 当生成此类问题时，遵循内部问题高级的问题的详细信息，请参阅以下链接。 时不生成问题，随后在 WPA 的分析是必需的;这种分析是本文的讨论范围之内。

**其他信息**

[MSDN: IRP\_明尼苏达州\_设置\_电源](http://go.microsoft.com/fwlink/?LinkId=247508)

### <a name="a-href-idoo-hiberfile-write-durationahiberfile-write-duration"></a><a href="" id="oo-hiberfile-write-duration"></a>后写持续时间

**最适用于︰**应用程序开发人员、 窗口服务开发、 驱动程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   休眠状态的性能

此指标衡量系统主内存的相关内容写入到辅助存储; 所花费的时间具体来说，到通常位于系统驱动器的根目录下的 hiberfile.sys 文件。

**详细的子指标**

规格，展开时，后的大小以千字节为单位显示。

**典型的影响因素**

写后所需的时间是需要写入的数据量成正比。 此数据包含正在使用的操作系统、 驱动程序和服务，以及任何系统必须读取系统恢复运行时，（如标识 Superfetch 准备内存阶段） 的数据的内存。

使用大量内存的驱动程序可能会影响该指标是让内存管理器将数据写入到后。 或者，启动应用程序可能会导致大量的数据可供读取的恢复路径上。 在这些情况下，Superfetch 服务可确保数据被纳入后以避免恢复路径上的慢速随机错误。

**请注意**  
硬驱物理性能特性，如序列写入吞吐量也会影响该指标。

 

**分析和补救措施**

用于标识特定的组件构成的更长的时间后写工期需要详细的内存分析，超出了本文的讨论范围。 但是，每个正在运行的驱动程序和服务可以导致此指标通过保留较大的内存分配。 数量和占地面积和启动过程中，读取数据的其他组件的启动应用程序，也会影响该指标。

### <a name="a-href-idoo-bios-initialization-durationabios-initialization-duration"></a><a href="" id="oo-bios-initialization-duration"></a>BIOS 初始化持续时间

**最适用于︰**BIOS 制造商

**相关评估︰**

1.  启动性能 （快速启动）

2.  启动性能 （完整的启动）

3.  待机性能

4.  休眠状态的性能

此指标用于衡量平台固件识别硬件设备初始化和运行加电自检 (POST)，所花费的时间。

**请注意**  
BIOS 初始化发生之前操作系统接收控制。 评估不能彻底检查阶段，其持续时间在可以只报告。

 

**详细的子指标**

启动性能 （快速启动） 是唯一的方案，此度量提供附加的子指标。 对于包含 BIOS，它支持高级配置和电源接口 (ACPI) 标准 (ACPI 5.0) 最新的系统，可以扩展此统计数据，以显示报告通过固件性能数据表格 (FPDT) 发布时间。 这是备用测量 BIOS 初始化期间，由内核检测报告。

**典型的影响因素**

引导顺序设置为系统的 BIOS 初始化期间可以延迟的重要来源。 此顺序可以要求它加载 Windows 之前检查可引导光盘、 软盘、 USB 数据线或其它硬盘的系统。 PXE 启动 （网络/远程启动） 还可以设置作为引导顺序;如果启用此选项，则会大大影响延迟。 某些 BIOS 配置还具有高级诊断程序或验证模式下，可能需要长时间才能完成。

**分析和补救措施**

没有附加信息被捕获为 BIOS 阶段。 典型的影响因素如启用 PXE 启动应进行检查。 当您需要进行会审，或更改这些设置时，应咨询 BIOS 制造商。 BIOS 初始化阶段深入调查已超出了本文的讨论范围。

### <a name="a-href-idoo-total-bootatotal-boot-excluding-bios-duration-total-resume-excluding-bios-duration"></a><a href="" id="oo-total-boot"></a>总启动\[不包括 BIOS\]持续时间和总恢复\[不包括 BIOS\]持续时间

**相关评估︰**

-   启动性能 （快速启动）

-   启动性能 （完整的启动）

-   待机性能

-   休眠状态的性能

此指标用于衡量计算机处于启动的时间。 此统计数据捕获从 BIOS 初始化结束到结束后开/关阶段，当系统达到空闲状态结束的时间。

**详细的子指标**

规格，展开时，在显示启动/恢复子阶段列表。

**请注意**  
这些子阶段的持续时间不一定等于总持续时间。

 

**典型的影响因素**

此统计数据是系统启动/恢复，总体指标，它可以受任何启动/恢复路径运行的软件组件。

**分析和补救措施**

展开子指标，提供了有关各个子阶段的详细信息，请参阅该度量。 检查各个子阶段指标和问题，以找到潜在延迟 contributors （参与者）。

### <a name="a-href-idoo-main-pathamain-path-boot-duration-main-path-resume-duration"></a><a href="" id="oo-main-path"></a>主路径引导持续时间与主路径恢复持续时间

**相关评估︰**

-   启动性能 （快速启动）

-   启动性能 （完整的启动）

-   待机性能

-   休眠状态的性能

此指标衡量从时间时计算机开始启动，直到该用户的桌面可见。 此统计数据捕获从 BIOS 初始化结束时间直到显示 Windows 8 用户界面，并且不包括开机自检开/关阶段。

**详细的子指标**

规格，展开时，显示组 （不包括过帐开/关阶段） 的子阶段。

**请注意**  
这些子阶段的持续时间不一定等于总持续时间。

 

**典型的影响因素**

此统计数据是启动/恢复可见桌面的总体指标。 它可以受任何桌面显示之前运行的软件组件。

**分析和补救措施**

展开子指标，提供了有关各个子阶段的详细信息，请参阅该度量。 检查各个子阶段指标和问题，以找到潜在延迟 contributors （参与者）。

### <a name="a-href-idoo-boot-manageraboot-manager"></a><a href="" id="oo-boot-manager"></a>引导管理器

**最适用于︰**系统管理员

**相关评估︰**

-   启动性能 （快速启动）

-   启动性能 （完整的启动）

-   休眠状态的性能

此指标衡量查找并启动 Winload.exe，操作系统加载程序，Windows 的引导分区上的时间。

**典型的影响因素**

此统计数据可能受到 BitLocker 操作，尤其是如果需要 BitLocker 启动 PIN。

**分析和补救措施**

使用 BitLocker 解锁不需要手动的 PIN 输入的方法。

### <a name="a-href-idoo-hiberfile-read-durationahiberfile-read-duration"></a><a href="" id="oo-hiberfile-read-duration"></a>读后持续时间

**最适用于︰**应用程序开发人员、 窗口服务开发、 驱动程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   休眠状态的性能

此指标用于衡量系统到主内存中读取后的内容所用的时间。

**详细的子指标**

当指标展开的时显示的大小 （以千字节为单位） 后。

**典型的影响因素**

阅读后所花费的时间是必须要读取的数据量成正比。 此数据包含使用的操作系统、 驱动程序和服务，以及系统使用系统恢复 （标识在关机/休眠的 Superfetch 准备内存阶段） 的数据的内存中的数据。

**请注意**  
硬盘的物理性能特性，如顺序读取吞吐量，也会影响该指标。

 

**分析和补救措施**

识别导致更长的时间后的特定组件读取工期要求详细的内存分析和超出了本文的讨论范围。

**请注意**  
每个正在运行的驱动程序和服务可以导致此指标通过保留较大的内存分配。 数量和启动应用程序和其他组件，它们在启动时读取数据所占用的空间也会影响该指标。

 

### <a name="a-href-idoo-resume-devices-durationaresume-devices-duration"></a><a href="" id="oo-resume-devices-duration"></a>恢复设备持续时间

**最适用于︰**驱动程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   待机性能

-   休眠状态的性能

在关机/休眠过程中每个设备驱动程序发送电源 (IRP\_MJ\_电源) 具有 IRP 的 IRP\_明尼苏达州\_设置\_电源次代码和工作电源状态。 设备驱动程序随后将设备电源 Irp 发送到相应的设备。 此指标衡量所有的驱动程序来处理一组电源 IRP 的时间。

**请注意**  
在此阶段中，驱动程序不应该保留系统电源 IRP。 每个驱动程序可以通过未及时处理系统电源 IRP 延迟系统启动。

 

**详细的子指标**

规格，展开时，更详细的阶段视图都会得到设备和其相应的持续时间的列表。

**典型的影响因素**

此统计数据捕获所有的驱动程序需要响应 IRP 的累计时间\_明尼苏达州\_设置\_电源电源请求。 此统计数据可能受到的单个驱动程序需要很长时间，除了所有驱动程序响应的累计时间。

**请注意**  
如果一个驱动程序拥有的设备的电源策略，它将生成响应接收系统电源 IRP 设备电源 IRP。 驱动程序不应该等到完成系统 IRP，直至设备 IRP 被完成，因为该等待可以防止其他设备接收其系统 Irp。 这一系列的等待原因序列化延迟并增加了整体暂停时间。

 

**分析和补救措施**

您可以标识一个驱动程序或驱动程序通过查看子指标影响该指标。 在驱动程序响应中的长时间延迟通常产生特定于给定驱动程序的问题。 当生成此类问题时，遵循内部问题高级的问题的详细信息，请参阅以下链接。 时不生成问题，随后在 WPA 的分析是必需的;这是本文的讨论范围之内。 请参阅[时间紧要任务的最佳做法](#fs-analysis)。

**其他信息**

[MSDN: IRP\_明尼苏达州\_设置\_电源](http://go.microsoft.com/fwlink/?LinkId=247508)

### <a name="a-href-idoo-operating-system-selection-menu-durationaoperating-system-selection-menu-duration"></a><a href="" id="oo-operating-system-selection-menu-duration"></a>操作系统选择菜单的持续时间

**最适用于︰**系统管理员

**相关评估︰**

-   启动性能 （快速启动）

此指标用于衡量操作系统选择菜单，使其默认选择所花费的时间。 默认情况下，过了 30 秒 （在没有用户交互） 进行选择。

**典型的影响因素**

此统计数据是系统行为的影响。 此统计数据报告已安装多个操作系统的系统上，它总是将报告 30 秒，如果执行无需用户交互。

**请注意**  
尽管系统的行为不会影响该指标的持续时间，引导过程有许多可以在这段时间运行的异步处理。 这些进程可以影响发生的默认选定区域后，由于部份通常在这些时间内执行的工作可能已经完成的活动的结果。

 

**分析和补救措施**

删除所有已安装的操作系统其他正在分析一种例外。 若要查看当前已安装操作系统 （包括影响此菜单的设置） 的列表，请在命令提示符处运行**msconfig.exe** ，然后选择**启动**选项卡。

### <a name="a-href-idoo-winlogon-resume-durationawinlogon-resume-duration"></a><a href="" id="oo-winlogon-resume-duration"></a>Winlogon 恢复持续时间

**最适用于︰**Winlogon 订阅服务器开发人员、 组策略脚本的所有者、 系统管理员、 凭据提供程序编写器

**相关评估︰**

-   启动性能 （快速启动）

-   休眠状态的性能

该指标表示多个 Winlogon 标注和操作，如交互使用 Winlogon 订阅服务器的时间跨度。 此统计数据不是订阅服务器通知中花费的累计的时间和它应该不这样认为。

**详细的子指标**

启动性能 （快速启动），是仅此度量提供附加的子指标的评估。 规格，展开时，则会出现包括引起 Winlogon 订阅服务器上的每个时间阶段更详细的视图。 在恢复过程中 Winlogon 发出到以下两种通知类型的已注册订阅服务器同步的订阅服务器通知︰

-   登录

-   启动外壳程序

它展开后，这些两种通知类型显示为子指标。 每种类型与其他子指标具有的订阅服务器 （例如，配置文件或 GPClient）。 每个订阅服务器上列出为该订阅服务器**连接到订阅服务器**并**调用订阅服务器上**的特定实例。

对于所有方案，Winlogon 订阅服务器可以延迟关闭的时间太长，要处理这些通知。 例如，如果在该计算机上启用了**漫游 （远程） 配置文件**功能 （配置文件） 中的配置文件服务必须进行同步的用户配置文件。 或者，可能由系统或域策略才能执行某些任务在用户登录时配置组策略客户端 (GPClient)。 这些任务是由系统管理员或域管理员，通常配置并通常运行非 Microsoft 的脚本所拥有。

**典型的影响因素**

检查此指标时，应重点处理登录和启动 Shell 的通知 Winlogon 订阅服务器。

**分析和补救措施**

检查各个订阅服务器操作的时间。 为长订阅服务器持续时间通常生成特定的问题。 您还可以通过打开到订阅服务器的时间间隔的 WPA 清楚了解。 例如，如果 GPClient 订阅服务器上调用仅需 10 秒，WPA 中的检查该持续时间可以揭示打满分 9 秒运行自定义脚本。 这可以在**进程的生存期**关系图。 它指示该脚本是延迟可能根源。

**其他信息**

[Winlogon 通知事件](http://go.microsoft.com/fwlink/?LinkId=247505)

### <a name="a-href-idoo-explorer-initialization-durationaexplorer-initialization-duration"></a><a href="" id="oo-explorer-initialization-duration"></a>资源管理器初始化持续时间

**最适用于︰**启动应用程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

此统计数据捕获从 Winlogon 阶段直到 Windows 外壳程序 (Explorer.exe) 报告开始初始化的屏幕结束的时间。 它包括 userinit.exe 进程，进而启动 Explorer.exe 的开始。 它还包括在**RunOnce**注册表项中存储的启动应用程序的启动。

**典型的影响因素**

如果没有**RunOnce**应用程序，应该初始化资源管理器进程花费大部分的时间在这一阶段。 资源管理器中将其初始化过程中读入内存库和数据文件的数量。 从正在运行的其他组件的争用 I/O 可以干扰并延迟此活动。

**分析和补救措施**

通常的资源管理器初始化阶段较长期限内生成特定的问题。 您可以通过打开资源管理器初始化活动的时间间隔向 WPA 获得更深的理解。 避免将应用程序放在定期**RunOnce**项，因为它会延迟资源管理器初始化。

研究资源管理器初始化过程中的具体问题已超出了本文的讨论范围。 常用的最佳实践的列表，请参阅[时间紧要任务的最佳做法](#fs-analysis)。

### <a name="a-href-idoo-post-on-off-durationapost-onoff-duration"></a><a href="" id="oo-post-on-off-duration"></a>开机自检打开/关闭持续时间

**最适用于︰**应用程序开发人员

**相关评估︰**

-   启动性能 （快速启动）

-   启动性能 （完整的启动）

-   待机性能

-   休眠状态的性能

此指标衡量完成开机自检开/关的系统相当空闲和积极地响应用户输入的时间。 此阶段的目标是将绑定并量化后将显示启动屏幕，继续的后台处理。 此指标衡量表示的正是所需要的系统累积 5 秒钟的空闲时间时间后开/关阶段的持续时间。 这一次累计通过检查 500年次 windows 中的 CPU 和存储利用率。 如果此窗口的闲置时间低于 20%，是 CPU 和存储利用率的累计时间 (500-最大\[CPU 时间、 磁盘时间\]窗口中) 被添加到总的空闲时间达到 5 秒钟。 指标报告此持续时间减去回收空闲时间 5 秒。

**请注意**  
这些计算的情况下，优先级低的 CPU 和存储器利用率的时间将被忽略。

 

在此阶段运行其他软件组件可以通过执行磁盘 I/O 或计算影响的阶段持续时间。

**详细的子指标**

没有实际的子指标存在此阶段;但是，由于资源利用率成正比的阶段持续时间，您可以清楚了解通过检查在此阶段运行的进程 （展开评估 Windows 控制台中的**每个阶段的进程**）。

**典型的影响因素**

在此阶段利用 CPU 或存储资源的任何软件组件可以为总体时间可能做出贡献。 其他启动应用程序后开/关阶段通常产生负面影响。

待机性能和休眠状态比方案，不注销用户会话，请在此阶段受到当前工作负荷中运行的应用程序。

**分析和补救措施**

标识进程占用了大部分资源。 你可以通过扩展 Windows 评估控制台中的**每个阶段的进程**或通过查看 CPU 和磁盘利用率曲线图和 WPA 中的汇总表。 问题也很可能会为生成违犯的进程。 查看更多详细信息的资源利用率指标 Looking。

若要解决启动性能 （快速启动） 并启动性能 （完整的启动） 进行评估的问题，请考虑从启动路径中删除不必要的应用程序或使用任务计划程序在以后启动这些应用程序。 如果用户登录的关键应用程序 （例如，它提供的凭据提供程序服务或网络服务），请确保该应用程序进行了优化的最小的资源消耗。

避免使用托管的代码 （基于 CLR 的） 启动应用程序，因为它们的初始化可以激活的.NET 框架资源昂贵初始化。 这进一步会影响后开/关阶段时间并降低用户的响应能力。

## <a name="a-href-idfs-issuesaissues"></a><a href="" id="fs-issues"></a>问题


开/关切换性能评估执行高级的问题分析，并提供链接到 WPA 评估已经发现的问题进行疑难解答。 WPA 打开时，可能还会有其他详细信息的磁盘活动或 CPU 活动可用，根据问题的类型。 本节介绍可用于分析性能问题的公共调查技术。

**发现最大的因素**

在 Windows 评估控制台中打开的评估结果文件并展开相应的父度量。 通常，子子指标影响父指标的特定组件上提供的信息。

例如，请考虑[关闭进程持续时间](#oo-shutdown-processes)指标。 您可以展开以查看该阶段的子指标的三个表的指标。 前两个表显示了 CPU 和磁盘利用率，以及第三个表显示正在关闭的单个进程的持续时间。

其他的列，如**详细信息**列提供子指标的更多详细信息。 在**用户会话关闭过程**中，**详细地**列显示 PID。

**请注意**  
在默认视图中，**详细地**列中可能包含值"各种"因为 Pid 不能聚合迭代间。 展开迭代来查看单个 Pid。

 

评估 Windows 控制台允许您按 （除了为最高级别快速启动阶段列表，在关机/启动过程中按阶段顺序进行排序） 的任何数据列排序子指标列表。

例如，在[用户会话关闭进程](#oo-user-session-shutdown-duration)阶段展开的流程列表中，用鼠标右键单击表格标题，然后选择**降序对行进行排序**。

这种技术可以用于多个顶层级别阶段持续时间。

**查看资源利用率指标**

在此阶段中查看的每个进程的详细的资源利用率指标。 若要检索此信息，展开的过程中部分，每个阶段选项卡，然后按 CPU 使用情况或总磁盘使用情况。

**其他信息**

深入分析的问题和建议有关的详细信息，请参阅[In-Depth 分析的常见问题](common-in-depth-analysis-issues.md)。

### <a name="the-assessment-reports-an-exit-code-of-0x80050006"></a>评估报告的退出代码为 0x80050006

维护任务已注册的电脑上，但尚未完成之前运行的评估时，将发生此错误。 为维护任务通常会影响评估指标，这样可以防止运行，这样的评估。

要解决此问题，请执行以下任一操作︰

1.  确保计算机已连接到网络和交流电源供电运行。 手动启动，请使用以下命令从提升提示符挂起的维护任务︰

    `rundll32.exe advapi32.dll,ProcessIdleTasks`

2.  禁用定期和空闲状态维护任务，并在运行评估之前停止所有的维护任务。

## <a name="a-href-idfs-analysisabest-practices-for-time-critical-tasks"></a><a href="" id="fs-analysis"></a>时间关键任务的最佳做法


如果不希望任务延迟，请确保它没有任何影响，这需要很长时间。 以下是一些方法来避免。

-   如果紧急响应是必需的例如，到进程 WM\_ENDSESSION 在关闭期间，不计划接收 （除了像用户修改，都必须保存的数据可靠性处理） 请求时进行任何实质性的工作。

-   应避免执行任何操作，这可能要花更长的时间，除非绝对必要。 推迟它们当前的时间关键任务已完成。 避免任何 Api 包含警告的:"谨防性能注意事项使用此 API 时"。

-   避免任何网络依赖项，因为任何网络请求可以延迟的网络问题。 这是对于启动和关机的情况下尤其如此，因为网络不能保证可的全部时间。

-   避免长时间的超时。 如果需要等待，确保等待时间相当受 （问题的时间关键任务的上下文） 中的一个小超时值。

-   避免过多的计算。 请记住，这样的计算采用 100 毫秒的速度非常快的计算机上可能最终采取慢一秒，速度在不同处理器。

-   避免不必要的存储 I/O。 其他组件可能会被延迟的任何 I/O 请求。 在任何时候，有许多典型的系统上运行的应用程序和服务和存储资源有限。 I/O 请求可能会获得排队背后数百个来自其他组件的类似请求。

-   避免磁盘刷新，例如，通过调用 FlushFileBuffers API 启动的那些。 正在刷新会导致删除其高速缓存的磁盘堆栈，并应在强制硬盘写出其 RAM 缓冲区中的数据。 通常情况下，此操作非常昂贵，并不保证数据的一致性，因为硬盘经常忽略的请求。

-   避免通过调用 RegFlushKey API 刷新注册表配置单元。 由于注册表设计 API 导致修改后的数据为整个蜂巢要刷新到磁盘中，这是非常昂贵的操作。 正在刷新注册表项是通常不需要因为操作系统提供一致的注册表视图的所有组件的操作。 此外，注册表本身执行异步刷新每隔几秒钟的时间。

-   不要打开新的 RPC 连接，因为 RPC 身份验证过程是成本高昂。 建立一个新的 RPC 连接涉及到代价高昂的安全检查。

-   避免调用 TxF Api 如事务性 Api，因为它们通常执行大量的代价高昂的操作对于每个 API 调用。 因此不应在时间关键型任务期间使用这些 Api，这些 Api 获得可靠性以性能为代价。

## <a name="related-topics"></a>相关的主题


[评估服务](assessments.md)

[开/关切换性能](onoff-transition-performance.md)

[自动重新启动前运行评估](automate-reboots-before-you-run-an-assessment.md)

[Windows 评估 Toolkit](index.md)

 

 







